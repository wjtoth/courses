\documentclass[letterpaper,12pt,oneside,onecolumn]{article}
\usepackage[margin=1in, bottom=1in, top=1in]{geometry} %1 inch margins
\usepackage{amsmath, amssymb, amstext}
\usepackage{fancyhdr}
\usepackage{mathtools}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{theorem}
\usepackage{tikz}
\usepackage{tkz-berge}
\usepackage[braket, qm]{qcircuit}

%Macros
\newcommand{\A}{\mathbb{A}} \newcommand{\C}{\mathbb{C}}
\newcommand{\D}{\mathbb{D}} \newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathbb{N}} \newcommand{\R}{\mathbb{R}}
\newcommand{\T}{\mathbb{T}} \newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
 
 
\newcommand{\cA}{\mathcal{A}} \newcommand{\cB}{\mathcal{B}}
\newcommand{\cC}{\mathcal{C}} \newcommand{\cD}{\mathcal{D}}
\newcommand{\cE}{\mathcal{E}} \newcommand{\cF}{\mathcal{F}}
\newcommand{\cG}{\mathcal{G}} \newcommand{\cH}{\mathcal{H}}
\newcommand{\cI}{\mathcal{I}} \newcommand{\cJ}{\mathcal{J}}
\newcommand{\cK}{\mathcal{K}} \newcommand{\cL}{\mathcal{L}}
\newcommand{\cM}{\mathcal{M}} \newcommand{\cN}{\mathcal{N}}
\newcommand{\cO}{\mathcal{O}} \newcommand{\cP}{\mathcal{P}}
\newcommand{\cQ}{\mathcal{Q}} \newcommand{\cR}{\mathcal{R}}
\newcommand{\cS}{\mathcal{S}} \newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}} \newcommand{\cV}{\mathcal{V}}
\newcommand{\cW}{\mathcal{W}} \newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}} \newcommand{\cZ}{\mathcal{Z}}

\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}


\newenvironment{proof}{{\bf Proof:  }}{\hfill\rule{2mm}{2mm}}
\newenvironment{proofof}[1]{{\bf Proof of #1:  }}{\hfill\rule{2mm}{2mm}}
\newenvironment{proofofnobox}[1]{{\bf#1:  }}{}\newenvironment{example}{{\bf Example:  }}{\hfill\rule{2mm}{2mm}}

%\renewcommand{\thesection}{\lecnum.\arabic{section}}
%\renewcommand{\theequation}{\thesection.\arabic{equation}}
%\renewcommand{\thefigure}{\thesection.\arabic{figure}}

\newtheorem{fact}{Fact}[section]
\newtheorem{lemma}[fact]{Lemma}
\newtheorem{theorem}[fact]{Theorem}
\newtheorem{definition}[fact]{Definition}
\newtheorem{corollary}[fact]{Corollary}
\newtheorem{proposition}[fact]{Proposition}
\newtheorem{claim}[fact]{Claim}
\newtheorem{exercise}[fact]{Exercise}
\newtheorem{note}[fact]{Note}
\newtheorem{conjecture}[fact]{Conjecture}

\newcommand{\size}[1]{\ensuremath{\left|#1\right|}}
\newcommand{\ceil}[1]{\ensuremath{\left\lceil#1\right\rceil}}
\newcommand{\floor}[1]{\ensuremath{\left\lfloor#1\right\rfloor}}

\DeclarePairedDelimiter\abs{\lvert}{\rvert}%
\DeclarePairedDelimiter\norm{\lVert}{\rVert}%
%END MACROS
%Page style
\pagestyle{fancy}

\listfiles

\raggedbottom

\lhead{\today}
\rhead{W. Justin Toth CO681-Quantum Information Processing A3} %CHANGE n to ASSIGNMENT NUMBER ijk TO COURSE CODE
\renewcommand{\headrulewidth}{1pt} %heading underlined
%\renewcommand{\baselinestretch}{1.2} % 1.2 line spacing for legibility (optional)

\begin{document}
\section{}
\subsection{a}
\paragraph{}
The phase estimation algorithm can be thought of as running a unitary matrix $W$ which maps $\ket{0}\ket{\phi}$ to $\ket{a}\ket{\phi}$ for any eigenvector $\ket{\phi}$ of $U$ with eigenvalue $\omega^a$, and then measuring the first register. So if we consider $\alpha\ket{\psi} + \beta\ket{\phi}$ then running phase estimation yields
$$W(\ket{0}(\alpha\ket{\psi} + \beta\ket{\phi})) = \alpha W(\ket{0}\ket{\psi}) + \beta W(\ket{0}\ket{\phi}) = \alpha \ket{a}\ket{\psi} + \beta\ket{b}\ket{\phi}$$
before measuring. So measuring the first register yields $\ket{a}$ with probability $|\alpha|^2$ and $b$ with probability $|\beta|^2$.
\subsection{b}
\paragraph{}
Let $\ket{\psi}$ be a normal vector in $\C^k$. Let $\ket{\phi^i}$ for $i=1,\dots, k$ be orthonormal eigenvectors of $U$ with corresponding eigenvalues $\lambda_1, \dots, \lambda_k$. Then since the set of $\ket{\phi^i}$ is a basis, there exist $\alpha_1, \dots, \alpha_k$ such that
$$\ket{\psi} = \sum_{i=1}^k \alpha_i \ket{\phi^i}.$$
So then $W$ acts on $\ket{\psi}$ as
$$W\ket{\psi} = \sum_{i=1}^k \alpha_i \ket{\lambda_i}\ket{\phi^i}.$$
Measuring the second register then yields $\ket{\phi^i}$ with probability $|\alpha_i|^2$. So then if we let $A_i = \ket{\phi^i}\bra{\phi^i}$ then $A_1, \dots, A_k$ forms a general measurement since the set $A_i$'s is a set of $k$ rank $1$ orthogonal projectors. If we let $\rho = \ket{\psi}\bra{\psi}$ then $Tr(A_i\rho A_i^\dagger) = |\alpha|^2$ and $\frac{1}{Tr(A_i\rho A_i^\dagger)} A_i \rho A_i^\dagger = \ket{\phi^i}\bra{\phi^i}$ as desired.
\section{}
\subsection{a}
\paragraph{}
The probability of getting outcome $j$ is
$$Tr(A_j\ket{\psi_j}\bra{\psi_j}A_j^\dagger) = \frac{1}{2} Tr(\ket{\psi_j}\bra{\psi_j}\ket{\psi_j}\bra{\psi_j}\ket{\psi_j}\bra{\psi_j}) = \frac{1}{2}Tr(\ip{\psi}{\psi}^3) = \frac{1}{2}.$$
\subsection{b}
\paragraph{}
Let $j \in \{0,1,2,3\}$. The density matrix resulting from measuring $\ket{\psi_j}$ is
$$\frac{1}{2}\ket{\psi_j}\bra{\psi_j} + \frac{1}{2}\ip{\psi_j}{\psi_{j+1}}^2\ket{\psi_{j+1}}\bra{\psi_{j+1}} + \frac{1}{2}\ip{\psi_j}{\psi_{j+3}}^2\ket{\psi_{j+3}}\bra{\psi_{j+3}}$$
where addition in the subscripts is taken modulo $4$. This simplifies as
$$\frac{1}{2}\ket{\psi_j}\bra{\psi_j} + \frac{1}{4}\ket{\psi_{j+1}}\bra{\psi_{j+1}} + \frac{1}{4}\ket{\psi_{j+3}}\bra{\psi_{j+3}}.$$
\subsection{c}
We implement the desired unitary matrix $U$ via the following quantum circuit
\[ \Qcircuit @C=1em @R=1em {
 \ket{k}\ \  \ & \qw &  \gate{H} & \qw\\
  \ket{0}\ \ \  & \gate{H} & \ctrl{-1} & \qw
}\]
with $k \in \{0,1\}$. When $k=0$ the circuit outputs the state $$\frac{1}{\sqrt{2}}\ket{00} + \frac{1}{2}\ket{01} + \frac{1}{2}\ket{11}$$ and when $k=1$ then circuit outputs the state $$\frac{1}{\sqrt{2}}\ket{10} + \frac{1}{2}\ket{01} - \frac{1}{2}\ket{11}$$
as desired.
\section{}
\subsection{a}
\paragraph{}
We can write any density matrix $\rho$ as
$$\frac{1}{2}\begin{bmatrix} 1+ r_z & r_x - i r_y \\ r_x + i r_y & 1-r_z \end{bmatrix}$$
Computing $T\rho T^{-1}$ then yields
$$\frac{1}{2}\begin{bmatrix} 1+r_z & \frac{r_x - r_y}{\sqrt{2}} -i\frac{r_x + r_y}{\sqrt{2}} \\ \frac{r_x - r_y}{\sqrt{2}} + i\frac{r_x + r_y}{\sqrt{2}} & 1-r_z\end{bmatrix}.$$
Then the corresponding affine linear map on $r$ sends $(r_x, r_y, r_z)$ to
$$ (\frac{r_x - r_y}{\sqrt{2}}, \frac{r_x+r_y}{\sqrt{2}}, r_z).$$
\subsection{b}
\paragraph{}
Using the same notation for $\rho$ as the previous part, we compute 
$$A_0\rho A_0^\dagger = \frac{1}{2}\begin{bmatrix}
1+r_z & \sqrt{p}(r_x - i r_y) \\ \sqrt{r}(r_x + ir_y) & p(1-r_z)
\end{bmatrix}$$
and $$A_1 \rho A_1^\dagger = \frac{1}{2}\begin{bmatrix} (1-p)(1-r_z) & 0 \\ 0 & 0 \end{bmatrix}.$$
So, adding the above and simplifying, the operator on $\rho$ yields
$$\begin{bmatrix}
1+ pr_z + 1-p & \sqrt{p}(r_x - i r_y) \\ \sqrt{p}(r_x + i r_y) & 1 - (pr_z + 1-p)
\end{bmatrix}.$$
Then the corresponding affine linear map on $r$ sends $(r_x, r_y, r_z)$ to
$$ (\sqrt{p}r_x, \sqrt{p}r_y, pr_z + 1-p).$$
\subsection{c}

\section{}
\subsection{a}
The density matrix for $\alpha\ket{00} + \beta\ket{11}$ is
$$\rho = |\alpha|^2\ket{00}\bra{00} + \alpha\beta^*\ket{00}\bra{11} + \alpha^*\beta\ket{11}\bra{00} + |\beta|^2\ket{11}\bra{11}.$$
Expanding in matrix notation we have
$$\rho = \begin{bmatrix}
|\alpha|^2 &0 & 0 &\alpha\beta^* \\
0 & 0 & 0 & 0\\
0 & 0 & 0 & 0\\
\alpha\beta^* & 0 & 0 &|\beta|^2.
\end{bmatrix}$$
So using the explicit formula for $Tr_1(\rho)$ we have
$$Tr_1(\rho) = \begin{bmatrix}
|\alpha|^2 & 0 \\
0 & |\beta|^2
\end{bmatrix}.$$

\subsection{b}
The second qubit is in state $\ket{0}$ with probability $|\alpha|^2$ and state $\ket{1}$ with probability $|\beta|^2$. Hence its average density matrix is
$$ \begin{bmatrix}
|\alpha|^2 & 0 \\
0 & |\beta|^2
\end{bmatrix}.$$

\subsection{c}
Let $A_0 = \sqrt{\frac{2}{3}}\begin{bmatrix}
1 & 0 \\ 0 & 0
\end{bmatrix}$, let $A_1 = \frac{1}{4} \begin{bmatrix}
\sqrt{2/3} & -\sqrt{2} \\ -\sqrt{2} & \sqrt{6}
\end{bmatrix}$, and let $A_2 = \frac{1}{4} \begin{bmatrix}
\sqrt{2/3} & \sqrt{2} \\ \sqrt{2} & \sqrt{6}
\end{bmatrix}.$
Let $\sigma = Tr_1(\rho) = \begin{bmatrix}
|\alpha|^2 & 0 \\
0 & |\beta|^2\end{bmatrix}$ be the density matrix of the second qubit after tracing out the first. Then
$$A_0\sigma A_0^\dagger = \frac{2}{3}\begin{bmatrix}
|\alpha|^2 & 0 \\ 0 & 0
\end{bmatrix}$$
and
$$Tr(A_0\sigma A_0^\dagger) = \frac{2}{3}|\alpha|^2.$$
Further
\begin{align*}A_1\sigma A_1^\dagger &= \frac{1}{16} \begin{bmatrix}
\sqrt{2/3} & -\sqrt{2} \\ -\sqrt{2} & \sqrt{6}
\end{bmatrix}\begin{bmatrix}
\sqrt{2/3}|\alpha|^2 & -\sqrt{2}|\alpha|^2 \\ -\sqrt{2}|\beta|^2 & \sqrt{6}|\beta|^2 \\&= 
\end{bmatrix}\\&= \frac{1}{16}\begin{bmatrix}
\frac{2}{3}|\alpha|^2 + 2|\beta|^2 & -\sqrt{2}(\sqrt{2/3}|\alpha|^2 + \sqrt{6}|\beta|^2) \\
 -\sqrt{2}(\sqrt{2/3}|\alpha|^2 + \sqrt{6}|\beta|^2) & 2|\alpha|^2 + 6|\beta|^2
\end{bmatrix}\end{align*}
and
$$Tr(A_1\sigma A_1^\dagger) = \frac{1}{16}(\frac{2}{3}|\alpha|^2 + 2|\beta|^2 + 2|\alpha|^2 + 6|\beta|^2)=\frac{1}{16}\big( (\frac{2}{3} + 2)|\alpha|^2 + 8|\beta|^2 \big).$$
Finally
$$A_2 \sigma A_2^\dagger = \frac{1}{16}\begin{bmatrix}
\frac{2}{3}|\alpha|^2 + 2|\beta|^2 & \sqrt{2}(\sqrt{2/3}|\alpha|^2 + \sqrt{6}|\beta|^2) \\
 \sqrt{2}(\sqrt{2/3}|\alpha|^2 + \sqrt{6}|\beta|^2) & 2|\alpha|^2 + 6|\beta|^2
\end{bmatrix}$$
and
$$Tr(A_2 \sigma A_2^\dagger) =\frac{1}{16}\big( (\frac{2}{3} + 2)|\alpha|^2 + 8|\beta|^2 \big).$$
The measurement probability for outcome $j \in \{0,1,2\}$ is $Tr(A_j \sigma A_j^\dagger)$ and the post-measurement state is $\frac{1}{Tr(A_j \sigma A_j^\dagger)}A_j\sigma A_j^\dagger.$

The average density matrix for the second qubit is
$$\sum_{j=0}^2 A_j \sigma A_j^\dagger.$$
\end{document}
