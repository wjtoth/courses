\documentclass[letterpaper,12pt,oneside,onecolumn]{article}
\usepackage[margin=1in, bottom=1in, top=1in]{geometry} %1 inch margins
\usepackage{amsmath, amssymb, amstext}
\usepackage{fancyhdr}
\usepackage{mathtools}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{theorem}
\usepackage{tikz}
\usepackage{tkz-berge}

\usepackage[braket, qm]{qcircuit}

%Macros
\newcommand{\A}{\mathbb{A}} \newcommand{\C}{\mathbb{C}}
\newcommand{\D}{\mathbb{D}} \newcommand{\F}{\mathbb{F}}
\newcommand{\N}{\mathbb{N}} \newcommand{\R}{\mathbb{R}}
\newcommand{\T}{\mathbb{T}} \newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
 
 
\newcommand{\cA}{\mathcal{A}} \newcommand{\cB}{\mathcal{B}}
\newcommand{\cC}{\mathcal{C}} \newcommand{\cD}{\mathcal{D}}
\newcommand{\cE}{\mathcal{E}} \newcommand{\cF}{\mathcal{F}}
\newcommand{\cG}{\mathcal{G}} \newcommand{\cH}{\mathcal{H}}
\newcommand{\cI}{\mathcal{I}} \newcommand{\cJ}{\mathcal{J}}
\newcommand{\cK}{\mathcal{K}} \newcommand{\cL}{\mathcal{L}}
\newcommand{\cM}{\mathcal{M}} \newcommand{\cN}{\mathcal{N}}
\newcommand{\cO}{\mathcal{O}} \newcommand{\cP}{\mathcal{P}}
\newcommand{\cQ}{\mathcal{Q}} \newcommand{\cR}{\mathcal{R}}
\newcommand{\cS}{\mathcal{S}} \newcommand{\cT}{\mathcal{T}}
\newcommand{\cU}{\mathcal{U}} \newcommand{\cV}{\mathcal{V}}
\newcommand{\cW}{\mathcal{W}} \newcommand{\cX}{\mathcal{X}}
\newcommand{\cY}{\mathcal{Y}} \newcommand{\cZ}{\mathcal{Z}}

\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}


\newenvironment{proof}{{\bf Proof:  }}{\hfill\rule{2mm}{2mm}}
\newenvironment{proofof}[1]{{\bf Proof of #1:  }}{\hfill\rule{2mm}{2mm}}
\newenvironment{proofofnobox}[1]{{\bf#1:  }}{}\newenvironment{example}{{\bf Example:  }}{\hfill\rule{2mm}{2mm}}

%\renewcommand{\thesection}{\lecnum.\arabic{section}}
%\renewcommand{\theequation}{\thesection.\arabic{equation}}
%\renewcommand{\thefigure}{\thesection.\arabic{figure}}

\newtheorem{fact}{Fact}[section]
\newtheorem{lemma}[fact]{Lemma}
\newtheorem{theorem}[fact]{Theorem}
\newtheorem{definition}[fact]{Definition}
\newtheorem{corollary}[fact]{Corollary}
\newtheorem{proposition}[fact]{Proposition}
\newtheorem{claim}[fact]{Claim}
\newtheorem{exercise}[fact]{Exercise}
\newtheorem{note}[fact]{Note}
\newtheorem{conjecture}[fact]{Conjecture}

\newcommand{\size}[1]{\ensuremath{\left|#1\right|}}
\newcommand{\ceil}[1]{\ensuremath{\left\lceil#1\right\rceil}}
\newcommand{\floor}[1]{\ensuremath{\left\lfloor#1\right\rfloor}}

\DeclarePairedDelimiter\abs{\lvert}{\rvert}%
\DeclarePairedDelimiter\norm{\lVert}{\rVert}%

%END MACROS
%Page style
\pagestyle{fancy}

\listfiles

\raggedbottom

\lhead{\today}
\rhead{W. Justin Toth CO681-Quantum Information Processing A1} %CHANGE n to ASSIGNMENT NUMBER ijk TO COURSE CODE
\renewcommand{\headrulewidth}{1pt} %heading underlined
%\renewcommand{\baselinestretch}{1.2} % 1.2 line spacing for legibility (optional)

\begin{document}
\section{}
\paragraph{}
Let $X = \begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix}$, $H = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 & 1 \\ 1 & -1 \end{bmatrix}$, $T = \begin{bmatrix} 1 & 0 \\ 0 & \zeta_8\end{bmatrix}$
\begin{itemize}
\item a) $\begin{bmatrix} 0 & 1 \\ \zeta_8 & 0 \end{bmatrix} = TX$
\item b) $\frac{1}{\sqrt{2}}\begin{bmatrix} 1 & 1 \\ -\zeta_8 & \zeta_8 \end{bmatrix} = THX$
\item c) $\frac{1}{\sqrt{2}}\begin{bmatrix} 1 &\zeta_8 \\ \zeta_8 & -i\end{bmatrix}=THT$
\item d) $\frac{1}{2} \begin{bmatrix} 1+\zeta_8 & 1-\zeta_8 \\ 1-\zeta_8 & 1+\zeta_8\end{bmatrix}=HTH.$
\end{itemize}
\section{}
\subsection{a}
\paragraph{}
Let $U$ be the unitary matrix for CNOT given by
$$U = \begin{bmatrix} 1 & 0 & 0 & 0 \\ 0& 1 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0& 0 & 1 &0 \end{bmatrix}.$$
The eigenvectors for $U$ are $\ket{00}$, $\ket{01}$, and $\ket{1+}$ all with eigenvalue $1$ and $\ket{1-}$ with eigenvalue $-1$. We have four orthonormal eigenvectors, so we've found all of them.
\subsection{b}
\paragraph{}
The circuit for $(H \otimes I)U$ is
\[ \Qcircuit @C=1em @R=1em {
 & \ctrl{1} & \gate{H} &  \qw \\
 & \targ &  \qw& \qw
}\]
and the corresponding unitary is
$$B:= \frac{1}{\sqrt{2}}\begin{bmatrix} 1 & 0 & 1 & 0 \\ 0 & 1 & 0 & 1 \\ 1 & 0 & -1 & 0 \\ 0 & 1 & 0 & -1 \end{bmatrix}\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0& 1 & 0 & 0 \\ 0 & 0 & 0 & 1 \\ 0& 0 & 1 &0 \end{bmatrix} = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 & 0 & 0 & 1 \\ 0 & 1 & 1 & 0 \\ 1 & 0 & 0 & -1\\ 0 & 1 & -1 & 0\end{bmatrix}.$$
\subsection{c}
\paragraph{}
Let $W$ be the unitary matrix for NOTC given by
$$W = \begin{bmatrix} 1 & 0 & 0 & 0 \\ 0& 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \\ 0& 1 & 0 &0 \end{bmatrix}.$$
The circuit for $(I \otimes H)W$ is
\[ \Qcircuit @C=1em @R=1em {
 & \targ & \qw &  \qw \\
 & \ctrl{-1} & \gate{H} & \qw
}\]
and the corresponding unitary is
$$C:= \frac{1}{\sqrt{2}}\begin{bmatrix} 1 & 1 & 0 & 0 \\ 1& -1 & 0 & 0 \\ 0 & 0 & 1 & 1 \\ 0& 0 & 1 &-1 \end{bmatrix}\begin{bmatrix} 1 & 0 & 0 & 0 \\ 0& 0 & 0 & 1 \\ 0 & 0 & 1 & 0 \\ 0& 1 & 0 &0 \end{bmatrix} = \frac{1}{\sqrt{2}} \begin{bmatrix} 1 & 0 & 0 & 1 \\ 1 & 0 & 0 & -1 \\ 0 & 1 & 1 & 0\\ 0 & -1 & 1 & 0\end{bmatrix}.$$
\subsection{d}
\paragraph{}
Since $(H\otimes H)U(H\otimes H) = W$ if and only if 
$$(I \otimes H)(H \otimes H) U(H \otimes H) = (I\otimes H) W$$
which simplifies as
$$(H\otimes I) U(H\otimes H) = (I \otimes H) W,$$
it suffices to show that $B (H\otimes H) = C$. Thus we compute
\begin{align*}B(H\otimes H) &= \frac{1}{\sqrt{2}} \begin{bmatrix} 1 & 0 & 0 & 1 \\ 0 & 1 & 1 & 0 \\ 1 & 0 & 0 & -1\\ 0 & 1 & -1 & 0\end{bmatrix}\cdot \frac{1}{2}\begin{bmatrix} 1 & 1 & 1 & 1 \\ 1 & - 1 & 1 & -1 \\ 1 & 1& -1 & -1 \\ 1 & -1 & -1 &1\end{bmatrix} \\
&=\frac{1}{\sqrt{2}}\cdot \frac{1}{2}\begin{bmatrix}2 &0 & 0 & 2 \\ 2 & 0 & 0 & -2 \\ 0 & 2 & 2 & 0 \\ 0 & -2 & 2 & 0 \end{bmatrix} \\
& C. \blacksquare\end{align*}
\section{}
\paragraph{}
Let $\ket{\psi} = \frac{1}{\sqrt{2}}\ket{00} + \frac{1}{2}\ket{01} + \frac{1}{2}\ket{11}.$
\subsection{a}
\paragraph{}
When we measure the first qubit with respect to the computational basis ($\ket{0}, \ket{1}$) we obtain $\ket{0}$ with probability
$$|\frac{1}{\sqrt{2}}|^2 + |\frac{1}{2}|^2 = \frac{3}{4}$$
and the second qubit would be left in the normalized post-measurement state
$$\sqrt{\frac{2}{3}} \ket{0} + \frac{1}{\sqrt{3}} \ket{1},$$
and we obtain $\ket{1}$ with probability
$$|\frac{1}{2}|^2 = \frac{1}{4}$$
and the second qubit would be left in the normalized post-measurement state
$$\ket{1}.$$
\subsection{b}
\paragraph{}
Rewriting $\ket{\psi}$ in the $\ket{+}, \ket{-}$ basis gives
$$\ket{\psi} = \frac{\sqrt{2} + 2}{4}\ket{++} + \frac{\sqrt{2}-2}{4}\ket{+-} + \frac{\sqrt{2}}{4}\ket{-+} + \frac{\sqrt{2}}{4}\ket{--}.$$
So measuring the first qubit with respect to the $\ket{+}, \ket{-}$ basis gives $\ket{+}$ with probability
$$|\frac{\sqrt{2}+2}{4}|^2+ |\frac{\sqrt{2}-2}{4}|^2 = \frac{3}{4}.$$
and the second qubit would be left in the normalized post-measurement state
$$ \frac{\sqrt{2} + 2}{2\sqrt{3}}\ket{+} + \frac{\sqrt{2}-2}{2\sqrt{3}}\ket{-},$$
and gives $\ket{-}$ with probability
$$2|\frac{\sqrt{2}}{4}|^2 = \frac{1}{4}$$
and the second qubit would be left in the normalized post-measurement state
$$\frac{1}{\sqrt{2}}\ket{+} + \frac{1}{\sqrt{2}}\ket{-} .$$
\section{}
\paragraph{}
Suppose that a qubit is prepared in the state $\ket{0}$ with probability $p$ and prepared in state $\ket{+}$ with probability $q$, where $p+q=1$ and $p,q\geq 0$. Then a measurement in the basis $\ket{\phi_0}, \ket{\phi_1}$ identifies the state successfully with probability
$$p\abs{\ip{\phi_0}{0}}^2 + q\abs{\ip{\phi_1}{+}}^2.$$
Since $\ket{0}$ and $\ket{+}$ lie in $\R^2$, the optimal $\ket{\phi_0}$ and $\ket{\phi_1}$ lie in $\R^2$ so as to optimize the length of projection of $\ket{\phi_0}$ and $\ket{\phi_1}$ onto $\ket{0}$ and $\ket{+}$ respectively (ie $\ip{\phi_0}{0}$ and $\ip{\phi_1}{+}$).
\paragraph{}
We can describe an arbitrary orthonormal basis of $\R^2$ as
$$\ket{\phi_0} = \begin{bmatrix} \cos\theta \\ \sin\theta \end{bmatrix}, \quad \ket{\phi_1}=\begin{bmatrix}-\sin\theta \\ \cos\theta \end{bmatrix}.$$
Now our success probability simplifies as
$$f(\theta) :=p\cos^2\theta + \frac{q}{2}(\cos\theta - \sin\theta)^2$$
with first derivative
$$f'(\theta) = -2p\sin\theta\cos\theta - q(\cos^2\theta - \sin^2\theta).$$
\subsection{a}
\paragraph{}
If we set $p=q=\frac{1}{2}$ then we have
$$f(\theta) = \frac{1}{2}\cos^2\theta + \frac{1}{4}(\cos\theta - \sin\theta)^2$$
and
$$f'(\theta) = -\sin\theta\cos\theta -\frac{1}{2}(\cos^2\theta-\sin^2\theta).$$
So $f$ is periodic with period $\pi$. Setting $f'(\theta)=0$ and solving we obtain one possible optimal solution: $\theta^* = \frac{-\pi}{8}.$
Since $f'(\frac{-2\pi}{8}) >0$ and $f'(0) < 0$, we know $\theta^*$ is a maximizer of $f$. Hence we have optimal success probability
$$f(\frac{-\pi}{8}) = \frac{1}{4}(2 + \sqrt(2)) \approx 0.85$$
and optimal basis
$$\ket{\phi_0} = \begin{bmatrix} \cos(\frac{-\pi}{8}) \\ \sin(\frac{-\pi}{8}) \end{bmatrix}, \quad \ket{\phi_1}=\begin{bmatrix}-\sin(\frac{-\pi}{8}) \\ \cos(\frac{-\pi}{8}) \end{bmatrix}.$$
\subsection{b}
\paragraph{}
If we set $p=\frac{3}{4}$ and $q=\frac{1}{4}$ then we have
$$f(\theta) = \frac{3}{4}\cos^2\theta + \frac{1}{8}(\cos\theta - \sin\theta)^2$$
and
$$f'(\theta) = -\frac{3}{2}\sin\theta\cos\theta -\frac{1}{4}(\cos^2\theta-\sin^2\theta).$$
So $f$ is periodic with period $\pi$. Setting $f'(\theta)=0$ and solving we obtain one possible optimal solution: $\theta^* = \arctan(3-\sqrt{10}).$
Since $f'(\arctan(3-\sqrt{10})-\frac{\pi}{4}) >0$ and $f'(\arctan(3-\sqrt{10}) + \frac{\pi}{4}) < 0$, we know $\theta^*$ is a maximizer of $f$. Hence we have optimal success probability
$$f(\arctan(3-\sqrt{10})) \approx 0.895$$
and optimal basis
$$\ket{\phi_0} = \begin{bmatrix} \cos(\arctan(3-\sqrt{10})) \\ \sin(arctan(3-\sqrt{10})) \end{bmatrix}, \quad \ket{\phi_1}=\begin{bmatrix}-\sin(\arctan(3-\sqrt{10})) \\ \cos(\arctan(3-\sqrt{10})) \end{bmatrix}.$$
\section{}
\subsection{a}
\paragraph{}
\begin{align*}
\ket{\Psi}^{12}\ket{\Psi}^{34} &= \frac{1}{2}(\ket{00}^{12} + \ket{11}^{12})(\ket{00}^{34} + \ket{11}^{34}) \\
&= \frac{1}{2}(\ket{00}^{12}\ket{00}^{34} + \ket{00}^{12}\ket{11}^{34} + \ket{11}^{12}\ket{00}^{34} + \ket{11}^12\ket{11}^{34})\\
&= \frac{1}{2}(\ket{00}^{23}\ket{00}^{14} + \ket{01}^{23}\ket{01}^{14} + \ket{10}^{23}\ket{10}^{34} + \ket{11}^{23}\ket{11}^{34}).
\end{align*}
Choose $\ket{\phi_{ab}} = \ket{\Psi_{ab}}$ for $a,b \in \{0,1\}$. Observe that 
\begin{align*}
&\ \ \ \ket{\Psi_{00}}^{23}\ket{\Psi_{00}}^{14} + \ket{\Psi_{11}}^{23}\ket{\Psi_{11}}^{14} \\
&= \frac{1}{2}(\ket{00}^{23}\ket{00}^{14} + \ket{00}^{23}\ket{11}^{14} + \ket{11}^{23}\ket{00}^{14} + \ket{11}^{23}\ket{11}^{14}) \\
&+ \frac{1}{2}(\ket{00}^{23}\ket{00}^{14} - \ket{00}^{23}\ket{11}^{14} - \ket{11}^{23}\ket{00}^{14} + \ket{11}^{23}\ket{11}^{14}) \\
&= \ket{00}^{23}\ket{00}^{14} + \ket{11}^{23}\ket{11}^{14}.
\end{align*}
and similarly by symmetry
$$\ket{\Psi_{01}}^{23}\ket{\Psi_{01}}^{14} + \ket{\Psi_{10}}^{23}\ket{\Psi_{10}}^{14} = \ket{01}^{23}\ket{01}^{14} + \ket{10}^{23}\ket{10}^{14} $$
So using the above observations we see that
\begin{align*}
&\ \ \ \frac{1}{2}(\ket{\Psi_{00}}^{23}\ket{\phi_{00}}^{14} + \ket{\Psi_{01}}^{23}\ket{\phi_{01}}^{14} + \ket{\Psi_{10}}^{23}\ket{\phi_{10}}^{14} \ket{\Psi_{11}}^{23}\ket{\phi_{11}}^{14}) \\
&= \frac{1}{2}(\ket{\Psi_{00}}^{23}\ket{\Psi_{00}}^{14} + \ket{\Psi_{01}}^{23}\ket{\Psi_{01}}^{14} + \ket{\Psi_{10}}^{23}\ket{\Psi_{10}}^{14} \ket{\Psi_{11}}^{23}\ket{\Psi_{11}}^{14}) \\
&= \frac{1}{2}(\ket{00}^{23}\ket{00}^{14} + \ket{01}^{23}\ket{01}^{14} + \ket{10}^{23}\ket{10}^{34} + \ket{11}^{23}\ket{11}^{34})
\end{align*}
as desired.
\subsection{b}
\paragraph{}
Performing a Bell measurement on qubits $2$ and $3$ yields state $\ket{\Psi_{ab}}$ with probability $\frac{1}{4}$ and qubits $1$ and $4$ are left in state $\ket{\Psi_{ab}}$ (for $a,b \in\{0,1\}$).
\end{document}
